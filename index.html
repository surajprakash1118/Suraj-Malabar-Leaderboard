<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGD Hesaraghatta v39.3</title>
    <style>
        :root {
            --bg-black: #050505;
            --card-bg: #121317;
            --precious: #ff8c00; 
            --divine: #ffff00;   
            --mine: #bf00ff;     
            --zoul: #00e5ff;     
            --neon-red-glow: #ff0000;
            --neon-green-growth: #39ff14;
        }

        body { 
            background-color: var(--bg-black); 
            color: white; 
            font-family: 'Segoe UI', sans-serif; 
            margin: 0; 
            padding: 15px; 
            text-transform: uppercase;
        }

        .timestamp {
            position: fixed;
            top: 15px;
            right: 15px;
            font-size: 10px;
            font-weight: 900;
            color: var(--divine);
            text-shadow: 0 0 8px var(--divine);
            background: rgba(0,0,0,0.5);
            padding: 5px 10px;
            border-radius: 5px;
            border: 1px solid var(--divine);
            z-index: 1001;
        }

        .critical-glow-red { border: 2px solid var(--neon-red-glow) !important; box-shadow: 0 0 25px var(--neon-red-glow) !important; }
        
        @keyframes blinker { 50% { opacity: 0; } }
        .blinking-warning { 
            animation: blinker 0.8s linear infinite; 
            color: var(--neon-red-glow); 
            text-shadow: 0 0 12px var(--neon-red-glow);
            font-size: 14px; 
        }

        .header { text-align: center; margin-bottom: 25px; }
        .main-title { color: var(--zoul); font-size: 28px; font-weight: 900; letter-spacing: 2px; text-shadow: 0 0 15px var(--zoul); margin: 0; }
        .sub-title { color: #ffffff; font-size: 14px; margin: 5px 0; }
        .deadline { color: var(--neon-red-glow); font-weight: bold; font-size: 18px; text-shadow: 0 0 10px var(--neon-red-glow); }

        .outer-box { border: 2px solid var(--zoul); border-radius: 20px; padding: 20px; margin-bottom: 25px; box-shadow: 0 0 15px rgba(0, 229, 255, 0.2); }
        .section-title { text-align: center; font-weight: 900; font-size: 20px; margin-bottom: 20px; letter-spacing: 2px; }

        .race-card { background: var(--card-bg); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid #333; position: relative; }
        .race-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .race-name { font-size: 20px; font-weight: 900; } 
        .manager-name { color: #ffffff; font-size: 12px; font-weight: normal; }
        .race-pct { font-size: 26px; font-weight: 900; }
        .race-track { background: #000; height: 32px; border-radius: 16px; overflow: hidden; position: relative; border: 1px solid #444; }
        .race-fill { height: 100%; border-radius: 16px; position: relative; transition: width 1s; }
        .race-icon { position: absolute; right: -5px; top: 50%; transform: translateY(-50%); font-size: 28px; filter: drop-shadow(0 0 5px white); }

        .staff-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 15px; }
        .staff-card { background: var(--card-bg); border-radius: 10px; padding: 12px; border: 1px solid #222; position: relative; }
        .staff-tag { display: inline-block; font-size: 10px; font-weight: 900; padding: 2px 8px; border-radius: 3px; color: black; margin-bottom: 8px; }
        .staff-name { font-size: 18px; font-weight: 900; margin-bottom: 6px; }
        .staff-stats { display: flex; justify-content: space-between; font-size: 10px; font-weight: bold; margin-bottom: 8px; }
        .staff-bar { background: #000; height: 8px; border-radius: 4px; width: 100%; overflow: hidden; }
        .staff-fill { height: 100%; transition: width 1s; }

        @keyframes crown-rotate { 0% { transform: rotateY(0deg); } 100% { transform: rotateY(360deg); } }
        .rotating-crown { display: inline-block; animation: crown-rotate 3s linear infinite; perspective: 1000px; margin-right: 8px; }

        .PRECIOUS-bg { background: var(--precious); }
        .DIVINE-bg { background: var(--divine); }
        .MINE-bg { background: var(--mine); }
        .ZOUL-bg { background: var(--zoul); }

        .ticker { background: #000; border-top: 2px solid var(--zoul); color: var(--zoul); position: fixed; bottom: 0; left: 0; width: 100%; padding: 10px; font-size: 14px; font-weight: bold; overflow: hidden; z-index: 1000; }
        .ticker-move { display: inline-block; white-space: nowrap; animation: move 25s linear infinite; }
        @keyframes move { from { transform: translateX(100%); } to { transform: translateX(-100%); } }
    </style>
</head>
<body>

    <div class="timestamp" id="last-update">UPDATED ON: --</div>

    <div class="header">
        <h1 class="main-title">MGD HESARAGHATTA</h1>
        <div class="sub-title">MANAGED BY SURAJ PRAKASH</div>
        <div id="deadline-timer" class="deadline">DEADLINE: CALCULATING...</div>
    </div>

    <div class="outer-box">
        <div class="section-title">TEAM RACE STANDINGS</div>
        <div id="team-racing"></div>
    </div>

    <div class="outer-box">
        <div class="section-title">STAFF LEADERBOARD</div>
        <div id="staff-leaderboard" class="staff-grid"></div>
    </div>

    <div class="ticker">
        <div class="ticker-move" id="ticker-text">SYNCHRONIZING MGD HUB v39.3...</div>
    </div>

    <script>
        const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS6tzd7SDpOQ6zHwIGlxNBRFGEG-62iLWa2wMyGyFgjxAWQC3KxP_qBicWEWuBaMsCz1Ydeq-im64_b/pub?gid=0&single=true&output=csv';

        // NEW: Specific Deadline Logic (Jan 26, 2026)
        function updateDeadline() {
            const now = new Date();
            const targetDate = new Date('2026-01-26T00:00:00'); 
            const diffTime = targetDate - now;
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays > 0) {
                document.getElementById('deadline-timer').innerText = `DEADLINE: ${diffDays} DAYS PENDING`;
            } else if (diffDays === 0) {
                document.getElementById('deadline-timer').innerText = `DEADLINE: TODAY IS THE DAY!`;
            } else {
                document.getElementById('deadline-timer').innerText = `DEADLINE: COMPLETED`;
            }
        }

        const getTeamColor = (name) => {
            const n = name.toUpperCase();
            if(n.includes('PRECIOUS')) return 'var(--precious)';
            if(n.includes('DIVINE')) return 'var(--divine)';
            if(n.includes('MINE')) return 'var(--mine)';
            if(n.includes('ZOUL')) return 'var(--zoul)';
            return '#ffffff';
        };

        async function updateDashboard() {
            try {
                const response = await fetch(SHEET_CSV_URL);
                const csvText = await response.text();
                const rows = csvText.split('\n');
                
                const headerCols = rows[0].split(',');
                if(headerCols[8]) {
                    document.getElementById('last-update').innerText = "UPDATED ON: " + headerCols[8].trim();
                }

                const dataRows = rows.slice(1);
                let teams = [];
                let staff = [];

                dataRows.forEach(row => {
                    const cols = row.split(',');
                    if(cols.length < 4) return;
                    
                    const entry = {
                        type: cols[0]?.trim().toLowerCase(),
                        name: cols[1]?.trim(),
                        sub: cols[2]?.trim().toUpperCase(),
                        curr: parseFloat(cols[3]) || 0,
                        prev: parseFloat(cols[4]) || 0,
                        icon: cols[5]?.trim() || 'üèéÔ∏è',
                        lastRank: cols[6] ? parseInt(cols[6].trim()) : null
                    };
                    if(entry.type === 'team') teams.push(entry);
                    else if(entry.type === 'staff') staff.push(entry);
                });

                const lowestTeamScore = teams.length ? Math.min(...teams.map(t => t.curr)) : 0;

                document.getElementById('team-racing').innerHTML = teams.map((t, i) => {
                    const growth = t.curr - t.prev;
                    const growthCol = growth > 0 ? "var(--neon-green-growth)" : "var(--neon-red-glow)";
                    const teamColor = getTeamColor(t.name);
                    const isLowest = t.curr === lowestTeamScore;

                    return `
                    <div class="race-card ${isLowest ? 'critical-glow-red' : ''}">
                        <div class="race-header">
                            <div class="race-name" style="color:${teamColor};">
                                ${isLowest ? '<span class="blinking-warning">‚ö†Ô∏è</span>' : ''}
                                ${i === 0 ? '<span class="rotating-crown">üëë</span>' : ''} 
                                ${t.name} <span class="manager-name">(${t.sub})</span> 
                                <span style="color:${growthCol}; font-size:12px; margin-left:10px; text-shadow: 0 0 5px ${growthCol};">
                                    ${growth > 0 ? '+' : ''}${growth.toFixed(0)}%
                                </span>
                            </div>
                            <div class="race-pct" style="color: ${teamColor}; text-shadow: 0 0 10px ${teamColor};">${t.curr}%</div>
                        </div>
                        <div class="race-track">
                            <div class="race-fill" style="width: ${t.curr}%; background: ${teamColor}; box-shadow: 0 0 18px ${teamColor}">
                                <span class="race-icon">${t.icon}</span>
                            </div>
                        </div>
                    </div>
                `}).join('');

                staff.sort((a,b) => b.curr - a.curr);
                document.getElementById('staff-leaderboard').innerHTML = staff.map((s, i) => {
                    const growth = s.curr - s.prev;
                    const growthCol = growth > 0 ? "var(--neon-green-growth)" : "var(--neon-red-glow)";
                    const teamColor = getTeamColor(s.sub);
                    const isCritical = s.curr < 15;
                    const isWarning = s.curr < 30;
                    const currentRank = i + 1;
                    
                    let trendIcon = '';
                    if (s.lastRank !== null && !isNaN(s.lastRank)) {
                        if (currentRank < s.lastRank) {
                            trendIcon = '<span style="color:var(--neon-green-growth); text-shadow: 0 0 5px var(--neon-green-growth);">‚¨ÜÔ∏è</span>';
                        } else if (currentRank > s.lastRank) {
                            trendIcon = '<span style="color:var(--neon-red-glow); text-shadow: 0 0 5px var(--neon-red-glow);">‚¨áÔ∏è</span>';
                        }
                    }

                    return `
                        <div class="staff-card ${isCritical ? 'critical-glow-red' : ''}">
                            <div class="staff-tag ${s.sub}-bg">${s.sub}</div>
                            <div class="staff-name" style="color:${teamColor};">
                                ${isWarning ? '<span class="blinking-warning">‚ö†Ô∏è</span>' : ''}
                                ${i === 0 ? '<span class="rotating-crown">üëë</span>' : ''}${s.name}
                            </div>
                            <div class="staff-stats">
                                <span style="color:${growthCol}; text-shadow: 0 0 5px ${growthCol};">${growth > 0 ? '+' : ''}${growth.toFixed(0)}% GROWTH</span>
                                <span style="color:#eee">${s.curr}% ACHIEVED</span>
                            </div>
                            <div class="staff-bar">
                                <div class="staff-fill" style="width: ${Math.min(s.curr, 100)}%; background: ${teamColor}; box-shadow: 0 0 12px ${teamColor}"></div>
                            </div>
                            <div style="position:absolute; right:10px; top:12px; font-size:10px; font-weight:900; color:#888;">${trendIcon} #${currentRank}</div>
                        </div>
                    `;
                }).join('');

                const tP = teams.find(t => t.name === 'PRECIOUS') || {curr:0, icon:'üèéÔ∏è'};
                const tD = teams.find(t => t.name === 'DIVINE') || {curr:0, icon:'üèçÔ∏è'};
                const tM = teams.find(t => t.name === 'MINE') || {curr:0, icon:'üèÉ'};
                const tZ = teams.find(t => t.name === 'ZOUL') || {curr:0, icon:'üö∂'};
                const topS = staff[0] || {name:'N/A', curr:0};

                document.getElementById('ticker-text').innerText = 
                    `Team Precious ${tP.icon} leading at ${tP.curr}% | Team Divine ${tD.icon} at ${tD.curr}% | Team Mine ${tM.icon} at ${tM.curr}% | Team Zoul ${tZ.icon} at ${tZ.curr}% | ${topS.name} Star Performer at ${topS.curr}% | managed by Suraj Prakash, v39.3`;

            } catch (e) { console.error("Sync Error", e); }
        }

        updateDeadline();
        setInterval(updateDashboard, 30000);
        updateDashboard();
    </script>
</body>
</html>
